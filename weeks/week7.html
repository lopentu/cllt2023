<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
<meta name="generator" content="quarto-1.3.306">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="謝舒凱 台大語言所">

<title>Computational linguisics and linguistic theories - Spring 2023 - Week 7 Syntax</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../weeks/week8.html" rel="next">
<link href="../weeks/week6.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
<link rel="stylesheet" href="../sydney-fonts.css">
<meta property="og:title" content="Computational linguisics and linguistic theories - Spring 2023 - Week 7 Syntax">
<meta property="og:description" content="">
<meta property="og:image" content="https://lopentu.github.io/cllt2023/images/chomsky.png">
<meta property="og:site-name" content="Computational linguisics and linguistic theories - Spring 2023">
<meta property="og:image:height" content="1238">
<meta property="og:image:width" content="2972">
<meta property="og:title" content="Computational linguisics and linguistic theories - Spring 2023 - Week 7 Syntax">
<meta property="og:description" content="後者較準確，處理長句較好，也能生成 non-projective dependency tree (對於不同於英語的其他類型語言很有幫助)。">
<meta property="og:image" content="https://lopentu.github.io/cllt2023/images/chomsky.png">
<meta property="og:site-name" content="Computational linguisics and linguistic theories - Spring 2023">
<meta property="og:image:height" content="1238">
<meta property="og:image:width" content="2972">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../weeks/week-1.html">每週教材</a></li><li class="breadcrumb-item"><a href="../weeks/week7.html">Week 7</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/logo.jpg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/lopentu" title="GitHub organization" class="quarto-navigation-tool px-1" aria-label="GitHub organization"><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">課程資訊</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">導覽</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">課綱</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-team.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">助教</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">時程</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-links.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">連結</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../computing-env.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">計算環境與作業繳交方式</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project-description.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">期末專題計劃需知</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">每週教材</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 6</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week7.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Week 7</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 8</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 9</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">補充說明</span></span>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#本週主題" id="toc-本週主題" class="nav-link active" data-scroll-target="#本週主題">本週主題</a>
  <ul class="collapse">
  <li><a href="#句法-syntax" id="toc-句法-syntax" class="nav-link" data-scroll-target="#句法-syntax">句法 | Syntax</a></li>
  <li><a href="#形式句法" id="toc-形式句法" class="nav-link" data-scroll-target="#形式句法">形式句法</a></li>
  <li><a href="#句法的計算表徵" id="toc-句法的計算表徵" class="nav-link" data-scroll-target="#句法的計算表徵">句法的計算表徵</a></li>
  </ul></li>
  <li><a href="#defining-constituency" id="toc-defining-constituency" class="nav-link" data-scroll-target="#defining-constituency">Defining Constituency</a>
  <ul class="collapse">
  <li><a href="#modeling-constituency" id="toc-modeling-constituency" class="nav-link" data-scroll-target="#modeling-constituency">Modeling constituency</a></li>
  <li><a href="#context-free-grammar" id="toc-context-free-grammar" class="nav-link" data-scroll-target="#context-free-grammar">Context-free Grammar</a></li>
  <li><a href="#例子" id="toc-例子" class="nav-link" data-scroll-target="#例子">例子</a></li>
  <li><a href="#處理形式上的各種空缺問題" id="toc-處理形式上的各種空缺問題" class="nav-link" data-scroll-target="#處理形式上的各種空缺問題">處理形式上的各種空缺問題</a></li>
  <li><a href="#parsing" id="toc-parsing" class="nav-link" data-scroll-target="#parsing">Parsing</a></li>
  <li><a href="#treebanks" id="toc-treebanks" class="nav-link" data-scroll-target="#treebanks">Treebanks</a></li>
  <li><a href="#例子-1" id="toc-例子-1" class="nav-link" data-scroll-target="#例子-1">例子</a></li>
  <li><a href="#formal-language-and-chomsky-normal-form" id="toc-formal-language-and-chomsky-normal-form" class="nav-link" data-scroll-target="#formal-language-and-chomsky-normal-form">Formal language and Chomsky normal form</a></li>
  <li><a href="#structural-ambiguity" id="toc-structural-ambiguity" class="nav-link" data-scroll-target="#structural-ambiguity">Structural Ambiguity</a></li>
  <li><a href="#練習中文歧義句" id="toc-練習中文歧義句" class="nav-link" data-scroll-target="#練習中文歧義句">練習中文歧義句</a></li>
  </ul></li>
  <li><a href="#剖析演算法" id="toc-剖析演算法" class="nav-link" data-scroll-target="#剖析演算法">剖析演算法</a>
  <ul class="collapse">
  <li><a href="#cky-parsing-algorithms" id="toc-cky-parsing-algorithms" class="nav-link" data-scroll-target="#cky-parsing-algorithms">CKY Parsing algorithms</a></li>
  <li><a href="#defining-dependencies" id="toc-defining-dependencies" class="nav-link" data-scroll-target="#defining-dependencies">Defining dependencies</a></li>
  <li><a href="#動詞的配價理論" id="toc-動詞的配價理論" class="nav-link" data-scroll-target="#動詞的配價理論">動詞的配價理論</a></li>
  <li><a href="#dependency-的形式定義" id="toc-dependency-的形式定義" class="nav-link" data-scroll-target="#dependency-的形式定義">Dependency 的形式定義</a></li>
  <li><a href="#幾個概念" id="toc-幾個概念" class="nav-link" data-scroll-target="#幾個概念">幾個概念</a></li>
  <li><a href="#dependency-relations" id="toc-dependency-relations" class="nav-link" data-scroll-target="#dependency-relations">Dependency relations</a></li>
  <li><a href="#dependency-formalisms" id="toc-dependency-formalisms" class="nav-link" data-scroll-target="#dependency-formalisms">Dependency Formalisms</a></li>
  <li><a href="#projectivity" id="toc-projectivity" class="nav-link" data-scroll-target="#projectivity">Projectivity</a></li>
  <li><a href="#practice" id="toc-practice" class="nav-link" data-scroll-target="#practice">Practice</a></li>
  </ul></li>
  <li><a href="#dependency-treebanks" id="toc-dependency-treebanks" class="nav-link" data-scroll-target="#dependency-treebanks">Dependency Treebanks</a></li>
  <li><a href="#dependency-parsing" id="toc-dependency-parsing" class="nav-link" data-scroll-target="#dependency-parsing">Dependency Parsing</a></li>
  <li><a href="#graph-based-dependency-parsing" id="toc-graph-based-dependency-parsing" class="nav-link" data-scroll-target="#graph-based-dependency-parsing">Graph-based Dependency Parsing</a>
  <ul class="collapse">
  <li><a href="#graph-based-dependency-parsing-1" id="toc-graph-based-dependency-parsing-1" class="nav-link" data-scroll-target="#graph-based-dependency-parsing-1">Graph-based Dependency Parsing</a></li>
  <li><a href="#chu-liuedmonds-algorithm" id="toc-chu-liuedmonds-algorithm" class="nav-link" data-scroll-target="#chu-liuedmonds-algorithm">Chu-Liu/Edmonds’ Algorithm</a></li>
  <li><a href="#先要瞭解何謂最大擴張樹-maximum-spanning-tree" id="toc-先要瞭解何謂最大擴張樹-maximum-spanning-tree" class="nav-link" data-scroll-target="#先要瞭解何謂最大擴張樹-maximum-spanning-tree">先要瞭解何謂最大擴張樹 (Maximum Spanning Tree)</a></li>
  <li><a href="#舉例" id="toc-舉例" class="nav-link" data-scroll-target="#舉例">舉例</a></li>
  <li><a href="#evaluation" id="toc-evaluation" class="nav-link" data-scroll-target="#evaluation">Evaluation</a></li>
  </ul></li>
  <li><a href="#dependency-parsing-with-llms" id="toc-dependency-parsing-with-llms" class="nav-link" data-scroll-target="#dependency-parsing-with-llms">Dependency Parsing with LLMs</a></li>
  <li><a href="#reflections" id="toc-reflections" class="nav-link" data-scroll-target="#reflections">Reflections</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/lopentu/cllt2023/edit/main/weeks/week7.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/lopentu/cllt2023/issues/new" class="toc-action">Report an issue</a></p></div></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="week7.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 7 Syntax</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>謝舒凱 台大語言所 </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="本週主題" class="level1">
<h1>本週主題</h1>
<ul>
<li>句法理論與計算表徵</li>
</ul>
<section id="句法-syntax" class="level2">
<h2 class="anchored" data-anchor-id="句法-syntax">句法 | Syntax</h2>
<ul>
<li><p>句法對於 NLP/NLU 很重要，因爲它涉及語言在表層的結構運作。</p></li>
<li><p>但是 (形式) 句法在近代語言學發展史中佔據了很大（太大！）的一部分</p></li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>N.Chomsky 對於語料庫，一直到現在的 LLM 的（鄙視）態度都一樣的，爲什麼呢？ <a href="https://www.youtube.com/watch?v=PbK71FdF2qc">2012 on corpus linguistics</a>; <a href="https://www.youtube.com/watch?v=-NMR5JXp37k">2023 on chatGPT</a></p>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/chomsky.png" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption class="figure-caption">不同的數學哲學</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/chomsky2.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">世紀論辯快要發生（結束）？</figcaption><p></p>
</figure>
</div>
</section>
<section id="形式句法" class="level2">
<h2 class="anchored" data-anchor-id="形式句法">形式句法</h2>
<p>Formal syntax/Geneartive Grammar</p>
<p>Theory</p>
<ul>
<li>【句法】是第一順位。In generative grammar, pride of place is given to syntax, 也具備自己的【獨立模組】。</li>
<li>【形式觀】：心智中的句法運算可以完全獨立於意義之外。</li>
</ul>
<p>Data</p>
<ul>
<li><em>top-down</em>，有限規則駕馭無限表達，重點在掌握 competence 而非 performace。</li>
<li>內省式語感判斷 rely on introspective judgments as their primary source of data.</li>
<li>the poverty-of-stimulus hypothesis (“the child has no data”).</li>
</ul>
</section>
<section id="句法的計算表徵" class="level2">
<h2 class="anchored" data-anchor-id="句法的計算表徵">句法的計算表徵</h2>
<p>兩種在計算語言學上常使用的句法表徵 (representation)：</p>
<pre><code>- dependency 
- constituency  </code></pre>
</section>
</section>
<section id="defining-constituency" class="level1">
<h1>Defining Constituency</h1>
<ul>
<li><strong>syntactic constituency</strong> is a syntactic unit that is a maximal projection of a syntactic category.
<ul>
<li><strong>syntactic category</strong> is a set of words that share a common syntactic property.</li>
<li>N 的 maximal project 是 NP，V 是 VP，PP 是 PP，等等。</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>從世界語言來看，這個概念是很值得爭議的。</p>
</div>
</div>
<section id="modeling-constituency" class="level2">
<h2 class="anchored" data-anchor-id="modeling-constituency">Modeling constituency</h2>
<ul>
<li><p>目前最爲廣泛用來 model constituency 的形式系統叫做 <strong>Context-free Grammar (CfG)</strong>， 在語言學中稱 <strong>Phrase Structure Grammar (PSG)</strong> 。</p></li>
<li><p>由 Chomsky 在 1950 年代提出，是一種用來描述語言句法結構的形式系統。</p></li>
</ul>
</section>
<section id="context-free-grammar" class="level2">
<h2 class="anchored" data-anchor-id="context-free-grammar">Context-free Grammar</h2>
<ul>
<li><p>a set of <strong>rules</strong> (or <strong>productions</strong>) that describe how to construct a sentence from smaller units.</p></li>
<li><p>形式上定義，CfG 是一個四元組 (4-tuple) <span class="math inline">\((N, \Sigma, R, S)\)</span>，其中：</p>
<ul>
<li><span class="math inline">\(N\)</span> 是一個有限集合，稱為 <strong>non-terminal symbols</strong>，代表句法結構的組成部分。</li>
<li><span class="math inline">\(\Sigma\)</span> 是一個有限集合，稱為 <strong>terminal symbols</strong>，代表句子中的詞。</li>
<li><span class="math inline">\(R\)</span> 是一個有限集合，稱為 <strong>rules</strong>，代表句法結構的生成規則。</li>
<li><span class="math inline">\(S\)</span> 是一個 <span class="math inline">\(N\)</span> 中的元素，稱為 <strong>start symbol</strong>，代表句子的根節點。</li>
</ul></li>
</ul>
</section>
<section id="例子" class="level2">
<h2 class="anchored" data-anchor-id="例子">例子</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/psr.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">妳快把我笑死了</figcaption><p></p>
</figure>
</div>
<p>如何解析以下句子？</p>
<blockquote class="blockquote">
<p>他說的都不對</p>
</blockquote>
</section>
<section id="處理形式上的各種空缺問題" class="level2">
<h2 class="anchored" data-anchor-id="處理形式上的各種空缺問題">處理形式上的各種空缺問題</h2>
<p>動詞的<strong>論元脫落</strong>有不同的符碼標記</p>
<ul>
<li>移位 (那個蘋果，我扔了)</li>
<li>隱含（她打算打網球）</li>
<li>空格（他買了兩根香蕉，給了他朋友一根）</li>
</ul>
</section>
<section id="parsing" class="level2">
<h2 class="anchored" data-anchor-id="parsing">Parsing</h2>
<p>句法剖析</p>
<ul>
<li>(自動地) 把一個句子 (a string of word) 映射到其對應的句法結構 (a parse tree)，就叫做 <strong>parsing</strong>。</li>
</ul>
</section>
<section id="treebanks" class="level2">
<h2 class="anchored" data-anchor-id="treebanks">Treebanks</h2>
<ul>
<li>一個 treebank 是一個語料庫，其中的每個句子都有一個對應的句法樹 (parse tree)。</li>
<li>這些句法樹通常是由訓練過的語言學家標註、或修訂過的。</li>
</ul>
<div class="callout-info">
<ul>
<li>Penn Treebank</li>
<li>CKIP Treebank</li>
</ul>
</div>
</section>
<section id="例子-1" class="level2">
<h2 class="anchored" data-anchor-id="例子-1">例子</h2>
</section>
<section id="formal-language-and-chomsky-normal-form" class="level2">
<h2 class="anchored" data-anchor-id="formal-language-and-chomsky-normal-form">Formal language and Chomsky normal form</h2>
<ul>
<li><p>It is useful to have a <strong>normal from</strong> (i.e., each of the production/rule taks a particular form) for formal languages, so that we can compare different formal languages and their grammars.</p></li>
<li><p><strong>Chomsky normal form (CNF)</strong> is a normal form for context-free grammars.</p>
<ul>
<li>A grammar is in CNF if all its rules are of the form:
<ul>
<li><span class="math inline">\(A \rightarrow BC\)</span></li>
<li><span class="math inline">\(A \rightarrow a\)</span></li>
<li><span class="math inline">\(S \rightarrow \epsilon\)</span></li>
</ul></li>
</ul></li>
</ul>
<p><a href="https://cs.uwaterloo.ca/~eblais/cs365/">cf.&nbsp;形式語言的計算理論</a></p>
<ul>
<li>Chomsky-adjunction</li>
</ul>
</section>
<section id="structural-ambiguity" class="level2">
<h2 class="anchored" data-anchor-id="structural-ambiguity">Structural Ambiguity</h2>
<p>結構歧義</p>
<ul>
<li><p>一個句子的句法結構可能有多種不同的解析方式，這就是結構歧義 (structural ambiguity)。</p></li>
<li><p>最常見的結構歧義類型：<strong>附加</strong> (attachment ambiguity) 和<strong>並列</strong> (coordination ambiguity)。</p></li>
</ul>
<blockquote class="blockquote">
<p>I shot an elephant in my pajamas</p>
</blockquote>
</section>
<section id="練習中文歧義句" class="level2">
<h2 class="anchored" data-anchor-id="練習中文歧義句">練習中文歧義句</h2>
<ul>
<li><p><span class="math inline">\(VP + NP_{1} + de + NP_{2}\)</span></p></li>
<li><p><span class="math inline">\(A + NP_{1} + NP_{2}\)</span></p></li>
</ul>
</section>
</section>
<section id="剖析演算法" class="level1">
<h1>剖析演算法</h1>
<section id="cky-parsing-algorithms" class="level2">
<h2 class="anchored" data-anchor-id="cky-parsing-algorithms">CKY Parsing algorithms</h2>
<ul>
<li><p>Dynamic Programming</p></li>
<li><p>Evaluation</p></li>
</ul>
</section>
<section id="defining-dependencies" class="level2">
<h2 class="anchored" data-anchor-id="defining-dependencies">Defining dependencies</h2>

<!-- text data is very versatile.
Using rules will be missing out on a lot of information. 
In Czech, a grammatical object might occur before or after a location adverbial. For example: ‘over the table’ can become ‘the table over’ in Czech & still make sense
-->
<ul>
<li><p>由法國語言學家 Lucien Tesnière 提出。</p></li>
<li><p>對於語序較爲自由的、構詞豐富的 (morphologically rich languages) 語言，rule-based approach 很難應付。(以 polymorphic languages 爲例)</p></li>
<li><p>此外，找到了主要語 (head) 及其依存 (dependent) 有助於<strong>語意剖析 (semantic parsing)</strong>。（可以容納句法和語意結構並存）</p></li>
</ul>
<p><span class="citation" data-cites="gerdes2013computational">(<a href="" role="doc-biblioref" onclick="return false;">Gerdes, Hajičová, and Wanner 2013</a>)</span></p>
</section>
<section id="動詞的配價理論" class="level2">
<h2 class="anchored" data-anchor-id="動詞的配價理論">動詞的配價理論</h2>
<p>主要語或中心語</p>
<ul>
<li><p>來自化學元素的類比：句子像是分子，由原子組成，而原子的核心是配價 (valence) （按一定的價結合在一起）。</p></li>
<li><p>動詞是中心，所有成分都是環繞着中心動詞開展的。</p></li>
<li><p>價數、價質（<code>semantic roles</code>）、價形 (<code>syntactic position</code>)</p></li>
</ul>
</section>
<section id="dependency-的形式定義" class="level2">
<h2 class="anchored" data-anchor-id="dependency-的形式定義">Dependency 的形式定義</h2>
<ul>
<li><p>一個句子的 dependency tree 是一個有向無環圖，其中每個節點代表一個詞，每個邊代表一個依存關係 (dependency relation)。</p></li>
<li><p>依存關係是一個非對稱的二元關係，其中一個元素是 <strong>head</strong>，另一個元素是 <strong>dependent</strong>。</p></li>
</ul>
<p><img src="../images/dependency.webp" class="img-fluid" style="width:90.0%"></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>非對稱的關係也帶出了階層的概念，此外，每個元素都可能同時支配與被支配。</p>
</div>
</div>
</section>
<section id="幾個概念" class="level2">
<h2 class="anchored" data-anchor-id="幾個概念">幾個概念</h2>
<ul>
<li><p>Head-Dependent 的箭頭方向：the origin word is the Head and the destination word is Dependent. (e.g., ‘prefer’ is Head &amp; ‘I’ is Dependent.)</p></li>
<li><p>Root: Word which is the root of our parse tree. (It is ‘prefer’ in the above example).</p></li>
<li><p>Grammar Functions and Arcs: Tags between each Head-Dependent pair is a grammar function determining the relation between the Head &amp; Dependent. The arrowhead carrying the tag is called an Arc.</p></li>
</ul>
</section>
<section id="dependency-relations" class="level2">
<h2 class="anchored" data-anchor-id="dependency-relations">Dependency relations</h2>
<!-- [Some basic linguistic relations](https://www.ling.upenn.edu/~beatrice/syntax-textbook/ch3.html) -->
<ul>
<li>關係種類有很多分類方式，這裏採取 <a href="https://universaldependencies.org/u/dep/">Universal Dependencies</a> 的分類方式。</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/dependency2.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Universal Dependencies</figcaption><p></p>
</figure>
</div>
</section>
<section id="dependency-formalisms" class="level2">
<h2 class="anchored" data-anchor-id="dependency-formalisms">Dependency Formalisms</h2>
<ul>
<li>圖論上來看，dependencies can be represented as a directed graph <span class="math inline">\(G= (V, A)\)</span> where V(set of <strong>vertices</strong>) represents words (and punctuation marks as well) in the sentence &amp; A( set of <strong>arcs</strong>) represent the grammar relationship between elements of V.</li>
</ul>
<!-- - 依存關係的表徵形式有很多種，常見的有：
    - **typed dependency** (e.g., Stanford typed dependency)
    - **untyped dependency** (e.g., Universal Dependency)
    - **dependency graph** (e.g., dependency tree/network)
    - etc. -->
<ul>
<li>A dependency parse tree is the directed graph which has the below features:
<ul>
<li>Root 沒有傳入的弧 (incoming arc) (can only be Head in Head-Dependent pair)</li>
<li>除了 root 之外的每一個節點，應該都只有一條傳入的弧 (Only one Parent/Head)</li>
<li>從 root 到每一個節點都只有一條路。</li>
</ul></li>
</ul>
<!-- 
# Dependency network

A dependency network is a graphical representation of the relationships among variables or entities in a complex system. 

In the context of natural language processing, dependency networks are used to represent the syntactic structure of sentences, where words are represented as nodes, and their grammatical relationships as edges connecting the nodes.


## 

- each node is connected to other nodes through **directed edges**, which indicate the dependency between the words. The direction of the edge typically goes from the head (governor) to the dependent (modifier). 

- This representation helps to identify the structure and hierarchical relations within a sentence, making it easier to understand and process. -->
</section>
<section id="projectivity" class="level2">
<h2 class="anchored" data-anchor-id="projectivity">Projectivity</h2>
<ul>
<li><strong>Projective arc</strong>: An <code>arc/arrows_with_tag</code> are projective when ‘Head’ associated with the arc has a path to reach each word that lies between ‘Head’ &amp; ‘Dependent’.</li>
</ul>
<p>以 (18.2) 爲例，<code>the</code> 和 <code>flights</code> 的 arc 是 <em>projective</em>，因爲在此的 Head (即 <code>flights</code>) 到它的 Dependent (即 <code>the</code>) 之間有個 <code>morning</code> 這個詞， Head 也有路可到得了。</p>
<p>同樣地，‘canceled’ (HEAD) 到 ‘flights’ (DEPENDENT) 這條 arc 也是 projective，因爲 Head 有路可到達它和其 Dependent 之間的詞。(i.e., ‘the’ (canceled <span class="math inline">\(\rightarrow\)</span> flights <span class="math inline">\(\rightarrow\)</span> the) 以及 ‘morning’ (canceled <span class="math inline">\(\rightarrow\)</span> flights <span class="math inline">\(\rightarrow\)</span> morning))</p>
<p><img src="../images/dep3.png" class="img-fluid"></p>
<ul>
<li><strong>Projective parse tree</strong>: A parse tree with all its arcs projective. The above tree is projective; A tree with at least one of the arcs as non-projective is called <strong>non-projective parse tree</strong>.</li>
</ul>
</section>
<section id="practice" class="level2">
<h2 class="anchored" data-anchor-id="practice">Practice</h2>
<p>以下這個 dependency parse tree 是 projective or non-projective? <img src="../images/dep4.webp" class="img-fluid"></p>
<!-- Here, the arc between ‘flight’ & ‘was’ is non-projective as there exists no path between ‘flight’ & ‘morning’ -->
</section>
</section>
<section id="dependency-treebanks" class="level1">
<h1>Dependency Treebanks</h1>
<ul>
<li><p>A dependency treebank is a collection of sentences with their corresponding dependency trees.</p></li>
<li><p>UD treebanks are available for 100+ languages.</p></li>
</ul>
</section>
<section id="dependency-parsing" class="level1">
<h1>Dependency Parsing</h1>
<ul>
<li>Transition-based</li>
<li>Graph-based</li>
</ul>
<p>後者較準確，處理長句較好，也能生成 non-projective dependency tree (對於不同於英語的其他類型語言很有幫助)。</p>
</section>
<section id="graph-based-dependency-parsing" class="level1">
<h1>Graph-based Dependency Parsing</h1>
<p>任務的定義：給定一個句子，找出一個 dependency tree，使得它的分數最高。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/parse.png" class="img-fluid figure-img" style="width:40.0%"></p>
<p></p><figcaption class="figure-caption">Search</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/score.png" class="img-fluid figure-img" style="width:40.0%"></p>
<p></p><figcaption class="figure-caption">Edge-factored assumption</figcaption><p></p>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>注意：<span class="math inline">\(y=f(x)\)</span>, <span class="math inline">\(y = maxf(x)\)</span>, <span class="math inline">\(y=argmax f(x)\)</span> 的不同！</p>
</div>
</div>
<section id="graph-based-dependency-parsing-1" class="level2">
<h2 class="anchored" data-anchor-id="graph-based-dependency-parsing-1">Graph-based Dependency Parsing</h2>
<p>歸結到兩個問題：</p>
<p>[1] assigning a score to each edge 給邊分數</p>
<p>[2] finding the best parse tree given the scores of all potential edges. 找出最好的依存樹</p>
</section>
<section id="chu-liuedmonds-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="chu-liuedmonds-algorithm">Chu-Liu/Edmonds’ Algorithm</h2>
<p>解 [2] 的方法</p>
<blockquote class="blockquote">
<p>It turns out that finding the best dependency parse for <span class="math inline">\(S\)</span> is equivalent to finding the <strong>maximum spanning tree</strong> over <span class="math inline">\(G\)</span>.</p>
</blockquote>
<ul>
<li>Chu-Liu/Edmonds’ Algorithm is a <strong>greedy algorithm</strong> for finding the maximum spanning tree of a graph.</li>
</ul>
</section>
<section id="先要瞭解何謂最大擴張樹-maximum-spanning-tree" class="level2">
<h2 class="anchored" data-anchor-id="先要瞭解何謂最大擴張樹-maximum-spanning-tree">先要瞭解何謂最大擴張樹 (Maximum Spanning Tree)</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/mst.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">MST</figcaption><p></p>
</figure>
</div>
</section>
<section id="舉例" class="level2">
<h2 class="anchored" data-anchor-id="舉例">舉例</h2>
<p><img src="../images/chuliu.png" class="img-fluid"></p>
</section>
<section id="evaluation" class="level2">
<h2 class="anchored" data-anchor-id="evaluation">Evaluation</h2>
<p>理想上的 <code>exact match</code> 指標是不太可行的。</p>
<ul>
<li><p><strong>Labeled Attachment Score (LAS)</strong>: the ratio of correctly detected Head-Dependent pairs along with their tag / total Head-Dependent pairs in testing data.</p></li>
<li><p><strong>Unlabeled Attachment Score (UAS)</strong>: the ratio of correctly detected Head_Dependent pairs (irrespective of the tag) / total Head-Dependent pairs in testing data.</p></li>
</ul>
<p><img src="../images/eval.png" class="img-fluid"></p>
<ul>
<li><p><code>Reference</code> 指的是標準答案，<code>System</code> 指的是系統生成的答案。</p></li>
<li><p><code>Total head-dependent pairs</code> 指的是句子中所有的 Head-Dependent pair, 不管在 <code>Reference</code> 或 <code>System</code> 都是 6 。</p></li>
<li><p><code>Total Head-Dependent pairs correctly detected with tags</code> = 4 (因爲 <code>System</code> 中的 <code>nsubj</code> 和 <code>det</code> 都是正確的)。</p></li>
<li><p><code>Total Head-Dependent pairs correctly detected</code> = 5 (因爲只管 pairs，不管 tags，所以 book <span class="math inline">\(\rightarrow\)</span> flight 也算)。</p></li>
</ul>
</section>
</section>
<section id="dependency-parsing-with-llms" class="level1">
<h1>Dependency Parsing with LLMs</h1>
<p><img src="../images/dep5.png" class="img-fluid"></p>
</section>
<section id="reflections" class="level1">
<h1>Reflections</h1>
<ul>
<li>Constituency/Dependency Parsing，強烈預設了<span class="blue-text">動詞爲核心</span>的語言假設，這點需要注意。</li>
</ul>
<!-- 
```{.python code-line-numbers="6-8"}
import numpy as np
import matplotlib.pyplot as plt

r = np.arange(0, 2, 0.01)
theta = 2 * np.pi * r
fig, ax = plt.subplots(subplot_kw={'projection': 'polar'})
ax.plot(theta, r)
ax.set_rticks([0.5, 1, 1.5, 2])
ax.grid(True)
plt.show()
``` -->



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-gerdes2013computational" class="csl-entry" role="listitem">
Gerdes, Kim, Eva Hajičová, and Leo Wanner. 2013. <em>Computational Dependency Theory</em>. Vol. 258. IOS Press.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../weeks/week6.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Week 6</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../weeks/week8.html" class="pagination-link">
        <span class="nav-page-text">Week 8</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© Copyright 2023, Shu-Kai Hsieh</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">網頁用 <a href="https://quarto.org/">Quarto</a> 設計</div>
  </div>
</footer>



</body></html>