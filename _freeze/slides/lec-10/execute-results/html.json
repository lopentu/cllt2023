{
  "hash": "aee52a7bbea276ed9c9aa24d47821c6e",
  "result": {
    "markdown": "---\ntitle: \"Types of predictors\"\nsubtitle: \"STA 210 - Spring 2022\"\nauthor: \"Dr. Mine Çetinkaya-Rundel\"\nfooter: \"[sta210-s22.github.io/website](https://sta210-s22.github.io/website/)\"\nlogo: \"images/logo.png\"\nformat: \n  revealjs:\n    theme: slides.scss\n    multiplex: true\n    transition: fade\n    slide-number: true\n    incremental: true \n    chalkboard: true\neditor: visual\nexecute:\n  freeze: auto\n---\n\n\n\n# Welcome\n\n## Announcements\n\n::: nonincremental\n-   Congratulations on finishing Exam 1!\n-   Grading of AEs\n-   Questions on feedback vs. regrades\n:::\n\n## Topics\n\n::: nonincremental\n-   Mean-centering quantitative predictors\n\n-   Using indicator variables for categorical predictors\n\n-   Using interaction terms\n:::\n\n## Computational setup\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# load packages\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(openintro)\nlibrary(patchwork)\nlibrary(knitr)\nlibrary(kableExtra)\nlibrary(colorblindr)\n\n# set default theme and larger font size for ggplot2\nggplot2::theme_set(ggplot2::theme_minimal(base_size = 20))\n```\n:::\n\n# Introduction\n\n## Data: Peer-to-peer lender\n\nToday's data is a sample of 50 loans made through a peer-to-peer lending club.\nThe data is in the `loan50` data frame in the **openintro** R package.\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-stdout}\n```\n# A tibble: 50 × 4\n   annual_income debt_to_income verified_income interest_rate\n           <dbl>          <dbl> <fct>                   <dbl>\n 1         59000         0.558  Not Verified            10.9 \n 2         60000         1.31   Not Verified             9.92\n 3         75000         1.06   Verified                26.3 \n 4         75000         0.574  Not Verified             9.92\n 5        254000         0.238  Not Verified             9.43\n 6         67000         1.08   Source Verified          9.92\n 7         28800         0.0997 Source Verified         17.1 \n 8         80000         0.351  Not Verified             6.08\n 9         34000         0.698  Not Verified             7.97\n10         80000         0.167  Source Verified         12.6 \n# … with 40 more rows\n```\n:::\n:::\n\n## Variables {.smaller}\n\n**Predictors**:\n\n::: nonincremental\n-   `annual_income`: Annual income\n-   `debt_to_income`: Debt-to-income ratio, i.e. the percentage of a borrower's total debt divided by their total income\n-   `verified_income`: Whether borrower's income source and amount have been verified (`Not Verified`, `Source Verified`, `Verified`)\n:::\n\n**Outcome**: `interest_rate`: Interest rate for the loan\n\n## Outcome: `interest_rate`\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](lec-10_files/figure-revealjs/unnamed-chunk-4-1.png){fig-align='center' width=3000}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> min </th>\n   <th style=\"text-align:right;\"> median </th>\n   <th style=\"text-align:right;\"> max </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 5.31 </td>\n   <td style=\"text-align:right;\"> 9.93 </td>\n   <td style=\"text-align:right;\"> 26.3 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n## Predictors\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](lec-10_files/figure-revealjs/unnamed-chunk-6-1.png){fig-align='center' width=3000}\n:::\n:::\n\n## Data manipulation 1: Rescale income\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nloan50 <- loan50 %>%\n  mutate(annual_income_th = annual_income / 1000)\n\nggplot(loan50, aes(x = annual_income_th)) +\n  geom_histogram(binwidth = 20) +\n  labs(title = \"Annual income (in $1000s)\")\n```\n\n::: {.cell-output-display}\n![](lec-10_files/figure-revealjs/unnamed-chunk-7-1.png){fig-align='center' width=3000}\n:::\n:::\n\n## Outcome vs. predictors\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](lec-10_files/figure-revealjs/unnamed-chunk-8-1.png){fig-align='center' width=3000}\n:::\n:::\n\n## Fit regression model\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nint_fit <- linear_reg() %>%\n  set_engine(\"lm\") %>%\n  fit(interest_rate ~ debt_to_income + verified_income  + annual_income_th,\n      data = loan50)\n```\n:::\n\n## Summarize model results {.smaller}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 10.726 </td>\n   <td style=\"text-align:right;\"> 1.507 </td>\n   <td style=\"text-align:right;\"> 7.116 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 7.690 </td>\n   <td style=\"text-align:right;\"> 13.762 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> debt_to_income </td>\n   <td style=\"text-align:right;\"> 0.671 </td>\n   <td style=\"text-align:right;\"> 0.676 </td>\n   <td style=\"text-align:right;\"> 0.993 </td>\n   <td style=\"text-align:right;\"> 0.326 </td>\n   <td style=\"text-align:right;\"> -0.690 </td>\n   <td style=\"text-align:right;\"> 2.033 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> verified_incomeSource Verified </td>\n   <td style=\"text-align:right;\"> 2.211 </td>\n   <td style=\"text-align:right;\"> 1.399 </td>\n   <td style=\"text-align:right;\"> 1.581 </td>\n   <td style=\"text-align:right;\"> 0.121 </td>\n   <td style=\"text-align:right;\"> -0.606 </td>\n   <td style=\"text-align:right;\"> 5.028 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> verified_incomeVerified </td>\n   <td style=\"text-align:right;\"> 6.880 </td>\n   <td style=\"text-align:right;\"> 1.801 </td>\n   <td style=\"text-align:right;\"> 3.820 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 3.253 </td>\n   <td style=\"text-align:right;\"> 10.508 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> annual_income_th </td>\n   <td style=\"text-align:right;\"> -0.021 </td>\n   <td style=\"text-align:right;\"> 0.011 </td>\n   <td style=\"text-align:right;\"> -1.804 </td>\n   <td style=\"text-align:right;\"> 0.078 </td>\n   <td style=\"text-align:right;\"> -0.043 </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n. . .\n\n<br>\n\n::: question\nDescribe the subset of borrowers who are expected to get an interest rate of 10.726% based on our model.\nIs this interpretation meaningful?\nWhy or why not?\n:::\n\n# Mean-centered variables\n\n## Mean-centering\n\nIf we are interested in interpreting the intercept, we can **mean-center** the quantitative predictors in the model.\n\nWe can mean-center a quantitative predictor $X_j$ using the following:\n\n$$X_{j_{Cent}} = X_{j}- \\bar{X}_{j}$$\n\n. . .\n\nIf we mean-center all quantitative variables, then the intercept is interpreted as the expected value of the response variable when all quantitative variables are at their mean value.\n\n## Data manipulation 2: Mean-center numeric predictors\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nloan50 <- loan50 %>%\n  mutate(\n    debt_inc_cent = debt_to_income - mean(debt_to_income), \n    annual_income_th_cent = annual_income_th - mean(annual_income_th)\n    )\n```\n:::\n\n## Visualize mean-centered predictors\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](lec-10_files/figure-revealjs/unnamed-chunk-12-1.png){fig-align='center' width=3000}\n:::\n:::\n\n## Using mean-centered variables in the model {.smaller}\n\n::: question\nHow do you expect the model to change if we use the `debt_inc_cent` and `annual_income_cent` in the model?\n:::\n\n. . .\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-stdout}\n```\n# A tibble: 5 × 7\n  term                  estimate std.error statistic  p.value conf.low conf.high\n  <chr>                    <dbl>     <dbl>     <dbl>    <dbl>    <dbl>     <dbl>\n1 (Intercept)             9.44      0.977      9.66  1.50e-12   7.48    11.4    \n2 debt_inc_cent           0.671     0.676      0.993 3.26e- 1  -0.690    2.03   \n3 verified_incomeSourc…   2.21      1.40       1.58  1.21e- 1  -0.606    5.03   \n4 verified_incomeVerif…   6.88      1.80       3.82  4.06e- 4   3.25    10.5    \n5 annual_income_th_cent  -0.0205    0.0114    -1.80  7.79e- 2  -0.0434   0.00238\n```\n:::\n:::\n\n## Original vs. mean-centered model {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 10.726 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> debt_to_income </td>\n   <td style=\"text-align:right;\"> 0.671 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> verified_incomeSource Verified </td>\n   <td style=\"text-align:right;\"> 2.211 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> verified_incomeVerified </td>\n   <td style=\"text-align:right;\"> 6.880 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> annual_income_th </td>\n   <td style=\"text-align:right;\"> -0.021 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n:::\n\n::: {.column width=\"50%\"}\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 9.444 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> debt_inc_cent </td>\n   <td style=\"text-align:right;\"> 0.671 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> verified_incomeSource Verified </td>\n   <td style=\"text-align:right;\"> 2.211 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> verified_incomeVerified </td>\n   <td style=\"text-align:right;\"> 6.880 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> annual_income_th_cent </td>\n   <td style=\"text-align:right;\"> -0.021 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n:::\n:::\n\n# Indicator variables\n\n## Indicator variables\n\n-   Suppose there is a categorical variable with $K$ categories (levels)\n\n-   We can make $K$ indicator variables - one indicator for each category\n\n-   An **indicator variable** takes values 1 or 0\n\n    -   1 if the observation belongs to that category\n    -   0 if the observation does not belong to that category\n\n## Data manipulation 3: Create indicator variables for `verified_income`\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nloan50 <- loan50 %>%\n  mutate(\n    not_verified = if_else(verified_income == \"Not Verified\", 1, 0),\n    source_verified = if_else(verified_income == \"Source Verified\", 1, 0),\n    verified = if_else(verified_income == \"Verified\", 1, 0)\n  )\n```\n:::\n\n. . .\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-stdout}\n```\n# A tibble: 3 × 4\n  verified_income not_verified source_verified verified\n  <fct>                  <dbl>           <dbl>    <dbl>\n1 Not Verified               1               0        0\n2 Verified                   0               0        1\n3 Source Verified            0               1        0\n```\n:::\n:::\n\n## Indicators in the model {.smaller}\n\n-   We will use $K-1$ of the indicator variables in the model.\n-   The **baseline** is the category that doesn't have a term in the model.\n-   The coefficients of the indicator variables in the model are interpreted as the expected change in the response compared to the baseline, holding all other variables constant.\n-   This approach is also called **dummy coding**.\n\n. . .\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-stdout}\n```\n# A tibble: 3 × 3\n  verified_income source_verified verified\n  <fct>                     <dbl>    <dbl>\n1 Not Verified                  0        0\n2 Verified                      0        1\n3 Source Verified               1        0\n```\n:::\n:::\n\n## Interpreting `verified_income` {.smaller}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 9.444 </td>\n   <td style=\"text-align:right;\"> 0.977 </td>\n   <td style=\"text-align:right;\"> 9.663 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 7.476 </td>\n   <td style=\"text-align:right;\"> 11.413 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> debt_inc_cent </td>\n   <td style=\"text-align:right;\"> 0.671 </td>\n   <td style=\"text-align:right;\"> 0.676 </td>\n   <td style=\"text-align:right;\"> 0.993 </td>\n   <td style=\"text-align:right;\"> 0.326 </td>\n   <td style=\"text-align:right;\"> -0.690 </td>\n   <td style=\"text-align:right;\"> 2.033 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: #D9E3E4 !important;\"> verified_incomeSource Verified </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> 2.211 </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> 1.399 </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> 1.581 </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> 0.121 </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> -0.606 </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> 5.028 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: #D9E3E4 !important;\"> verified_incomeVerified </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> 6.880 </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> 1.801 </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> 3.820 </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> 0.000 </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> 3.253 </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> 10.508 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> annual_income_th_cent </td>\n   <td style=\"text-align:right;\"> -0.021 </td>\n   <td style=\"text-align:right;\"> 0.011 </td>\n   <td style=\"text-align:right;\"> -1.804 </td>\n   <td style=\"text-align:right;\"> 0.078 </td>\n   <td style=\"text-align:right;\"> -0.043 </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n. . .\n\n-   The baseline category is `Not verified`.\n-   People with source verified income are expected to take a loan with an interest rate that is 2.211% higher, on average, than the rate on loans to those whose income is not verified, holding all else constant.\n-   People with verified income are expected to take a loan with an interest rate that is 6.880% higher, on average, than the rate on loans to those whose income is not verified, holding all else constant.\n\n# Interaction terms\n\n## Interaction terms\n\n-   Sometimes the relationship between a predictor variable and the response depends on the value of another predictor variable.\n-   This is an **interaction effect**.\n-   To account for this, we can include **interaction terms** in the model.\n\n## Interest rate vs. annual income\n\nThe lines are not parallel indicating there is an **interaction effect**.\nThe slope of annual income differs based on the income verification.\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](lec-10_files/figure-revealjs/unnamed-chunk-20-1.png){fig-align='center' width=3000}\n:::\n:::\n\n## Interaction term in model {.smaller}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nint_cent_int_fit <- linear_reg() %>%\n  set_engine(\"lm\") %>%\n  fit(interest_rate ~ debt_inc_cent  +  debt_inc_cent + \n        annual_income_th_cent + verified_income * annual_income_th_cent,\n      data = loan50)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 9.484 </td>\n   <td style=\"text-align:right;\"> 0.989 </td>\n   <td style=\"text-align:right;\"> 9.586 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> debt_inc_cent </td>\n   <td style=\"text-align:right;\"> 0.691 </td>\n   <td style=\"text-align:right;\"> 0.685 </td>\n   <td style=\"text-align:right;\"> 1.009 </td>\n   <td style=\"text-align:right;\"> 0.319 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> annual_income_th_cent </td>\n   <td style=\"text-align:right;\"> -0.007 </td>\n   <td style=\"text-align:right;\"> 0.020 </td>\n   <td style=\"text-align:right;\"> -0.341 </td>\n   <td style=\"text-align:right;\"> 0.735 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> verified_incomeSource Verified </td>\n   <td style=\"text-align:right;\"> 2.157 </td>\n   <td style=\"text-align:right;\"> 1.418 </td>\n   <td style=\"text-align:right;\"> 1.522 </td>\n   <td style=\"text-align:right;\"> 0.135 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> verified_incomeVerified </td>\n   <td style=\"text-align:right;\"> 7.181 </td>\n   <td style=\"text-align:right;\"> 1.870 </td>\n   <td style=\"text-align:right;\"> 3.840 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: #D9E3E4 !important;\"> annual_income_th_cent:verified_incomeSource Verified </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> -0.016 </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> 0.026 </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> -0.643 </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> 0.523 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: #D9E3E4 !important;\"> annual_income_th_cent:verified_incomeVerified </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> -0.032 </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> 0.033 </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> -0.979 </td>\n   <td style=\"text-align:right;background-color: #D9E3E4 !important;\"> 0.333 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n## Interpreting interaction terms\n\n-   What the interaction means: The effect of annual income on the interest rate differs by -0.016 when the income is source verified compared to when it is not verified, holding all else constant.\n-   Interpreting `annual_income` for source verified: If the income is source verified, we expect the interest rate to decrease by 0.023% (-0.007 + -0.016) for each additional thousand dollars in annual income, holding all else constant.\n\n## Data manipulation 4: Create interaction variables {.smaller}\n\nDefining the interaction variable in the model formula as `verified_income * annual_income_th_cent` is an implicit data manipulation step as well\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-stdout}\n```\nRows: 50\nColumns: 9\n$ `(Intercept)`                                          <dbl> 1, 1, 1, 1, 1, …\n$ debt_inc_cent                                          <dbl> -0.16511719, 0.…\n$ annual_income_th_cent                                  <dbl> -27.17, -26.17,…\n$ `verified_incomeNot Verified`                          <dbl> 1, 1, 0, 1, 1, …\n$ `verified_incomeSource Verified`                       <dbl> 0, 0, 0, 0, 0, …\n$ verified_incomeVerified                                <dbl> 0, 0, 1, 0, 0, …\n$ `annual_income_th_cent:verified_incomeNot Verified`    <dbl> -27.17, -26.17,…\n$ `annual_income_th_cent:verified_incomeSource Verified` <dbl> 0.00, 0.00, 0.0…\n$ `annual_income_th_cent:verified_incomeVerified`        <dbl> 0.00, 0.00, -11…\n```\n:::\n:::\n\n# Wrap up\n\n## Recap\n\n-   Mean-centering quantitative predictors\n\n-   Using indicator variables for categorical predictors\n\n-   Using interaction terms\n\n## Looking backward {.smaller}\n\nData manipulation, with **dplyr** (from **tidyverse**):\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nloan50 %>%\n  select(interest_rate, annual_income, debt_to_income, verified_income) %>%\n  mutate(\n    # 1. rescale income\n    annual_income_th = annual_income / 1000,\n    # 2. mean-center quantitative predictors\n    debt_inc_cent = debt_to_income - mean(debt_to_income),\n    annual_income_th_cent = annual_income_th - mean(annual_income_th),\n    # 3. create dummy variables for verified_income\n    source_verified = if_else(verified_income == \"Source Verified\", 1, 0),\n    verified = if_else(verified_income == \"Verified\", 1, 0),\n    # 4. create interaction variables\n    `annual_income_th_cent:verified_incomeSource Verified` = annual_income_th_cent * source_verified,\n    `annual_income_th_cent:verified_incomeVerified` = annual_income_th_cent * verified\n  )\n```\n:::\n\n## Looking forward {.smaller}\n\n**Feature engineering**, with **recipes** (from **tidymodels**):\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nloan_rec <- recipe( ~ ., data = loan50) %>%\n  # 1. rescale income\n  step_mutate(annual_income_th = annual_income / 1000) %>%\n  # 2. mean-center quantitative predictors\n  step_center(all_numeric_predictors()) %>%\n  # 3. create dummy variables for verified_income\n  step_dummy(verified_income) %>%\n  # 4. create interaction variables\n  step_interact(terms = ~ annual_income_th:verified_income)\n```\n:::\n\n## Recipe\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nloan_rec\n```\n\n::: {.cell-output-stdout}\n```\nRecipe\n\nInputs:\n\n      role #variables\n predictor         24\n\nOperations:\n\nVariable mutation\nCentering for all_numeric_predictors()\nDummy variables from verified_income\nInteractions with annual_income_th:verified_income\n```\n:::\n:::",
    "supporting": [
      "lec-10_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    function fireSlideChanged(previousSlide, currentSlide) {\n\n      // dispatch for htmlwidgets\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for reveal\n    if (window.Reveal) {\n      window.Reveal.addEventListener(\"slidechanged\", function(event) {\n        fireSlideChanged(event.previousSlide, event.currentSlide);\n      });\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}